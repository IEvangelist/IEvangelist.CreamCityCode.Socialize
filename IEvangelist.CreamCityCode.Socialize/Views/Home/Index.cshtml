@model ShareViewModel

@section metatags {
    <meta name="twitter:image" content="@Model.ImageUrl">
    <meta name="twitter:url" content="@Model.ImageUrl">
    <meta property="og:image" content="@Model.ImageUrl">
    <meta property="og:url" content="@Model.ImageUrl">
    <meta itemprop="image" content="@Model.ImageUrl">
}

<div class="container-fluid">
    <div class="row">
        <div class="col-12 body-content">


            @if (Model.IsSingleImage)
            {
                <div class="wrapper">
                    <div class="gif">
                        <img src="@Model.ImageUrl" alt="Cream City Code Selfie Animation" />
                    </div>

                    <section class="facebook" onclick="onFacebookClick()">
                        <div>
                            <svg viewBox="0 0 512 512">
                                <path d="M211.9 197.4h-36.7v59.9h36.7V433.1h70.5V256.5h49.2l5.2-59.1h-54.4c0 0 0-22.1 0-33.7 0-13.9 2.8-19.5 16.3-19.5 10.9 0 38.2 0 38.2 0V82.9c0 0-40.2 0-48.8 0 -52.5 0-76.1 23.1-76.1 67.3C211.9 188.8 211.9 197.4 211.9 197.4z"></path>
                            </svg>
                        </div>
                    </section>
                    <section class="twitter" onclick="onTwitterClick()">
                        <div>
                            <svg viewBox="0 0 512 512">
                                <path d="M419.6 168.6c-11.7 5.2-24.2 8.7-37.4 10.2 13.4-8.1 23.8-20.8 28.6-36 -12.6 7.5-26.5 12.9-41.3 15.8 -11.9-12.6-28.8-20.6-47.5-20.6 -42 0-72.9 39.2-63.4 79.9 -54.1-2.7-102.1-28.6-134.2-68 -17 29.2-8.8 67.5 20.1 86.9 -10.7-0.3-20.7-3.3-29.5-8.1 -0.7 30.2 20.9 58.4 52.2 64.6 -9.2 2.5-19.2 3.1-29.4 1.1 8.3 25.9 32.3 44.7 60.8 45.2 -27.4 21.4-61.8 31-96.4 27 28.8 18.5 63 29.2 99.8 29.2 120.8 0 189.1-102.1 185-193.6C399.9 193.1 410.9 181.7 419.6 168.6z"></path>
                            </svg>
                        </div>
                    </section>
                    <section onclick="onLinkedinClick()" class="linkedin">
                        <div>
                            <svg viewBox="0 0 512 512">
                                <path d="M186.4 142.4c0 19-15.3 34.5-34.2 34.5 -18.9 0-34.2-15.4-34.2-34.5 0-19 15.3-34.5 34.2-34.5C171.1 107.9 186.4 123.4 186.4 142.4zM181.4 201.3h-57.8V388.1h57.8V201.3zM273.8 201.3h-55.4V388.1h55.4c0 0 0-69.3 0-98 0-26.3 12.1-41.9 35.2-41.9 21.3 0 31.5 15 31.5 41.9 0 26.9 0 98 0 98h57.5c0 0 0-68.2 0-118.3 0-50-28.3-74.2-68-74.2 -39.6 0-56.3 30.9-56.3 30.9v-25.2H273.8z"></path>
                            </svg>
                        </div>
                    </section>
                    <section class="google" onclick="onGooglePlusClick()">
                        <div>
                            <svg viewBox="0 0 512 512">
                                <path d="M179.7 237.6L179.7 284.2 256.7 284.2C253.6 304.2 233.4 342.9 179.7 342.9 133.4 342.9 95.6 304.4 95.6 257 95.6 209.6 133.4 171.1 179.7 171.1 206.1 171.1 223.7 182.4 233.8 192.1L270.6 156.6C247 134.4 216.4 121 179.7 121 104.7 121 44 181.8 44 257 44 332.2 104.7 393 179.7 393 258 393 310 337.8 310 260.1 310 251.2 309 244.4 307.9 237.6L179.7 237.6 179.7 237.6ZM468 236.7L429.3 236.7 429.3 198 390.7 198 390.7 236.7 352 236.7 352 275.3 390.7 275.3 390.7 314 429.3 314 429.3 275.3 468 275.3"></path>
                            </svg>
                        </div>
                    </section>
                </div>
            }
            else
            {
                <div class="image-grid">
                    <div id="west-logo">
                        <img src="images/ccc-logo.png" alt="Cream City Code 2018" />
                    </div>
                    <div id="one">
                        @foreach (var uri in Model.FirstQuarter)
                        {
                            <img class="image" src="@uri" alt="Cream City Code 2018" />
                        }
                    </div>
                    <div id="two">
                        @foreach (var uri in Model.SecondQuarter)
                        {
                            <img class="image" src="@uri" alt="Cream City Code 2018" />
                        }
                    </div>
                    <div id="three">
                        @foreach (var uri in Model.ThirdQuarter)
                        {
                            <img class="image" src="@uri" alt="Cream City Code 2018" />
                        }
                    </div>
                    <div id="four">
                        @foreach (var uri in Model.FourthQuarter)
                        {
                            <img class="image" src="@uri" alt="Cream City Code 2018" />
                        }
                    </div>
                    <div id="east-logo">
                        <img src="images/ccc-logo.png" alt="Cream City Code 2018" />
                    </div>
                </div>

                <script type="text/javascript">
                    $(function () {
                        const SlideShow = (function () {
                            function SlideShow(selector, interval) {
                                if (interval === void 0) {
                                    interval = 4250;
                                }
                                this.selector = selector;
                                this.interval = interval;
                                this.index = 0;
                                this.fadeOutTime = 400;
                                this.fadeInTime = 10;
                                this.isPaused = false;
                                this.images = $(selector).children('img');
                                this.imageCount = this.images.length;
                            }

                            SlideShow.prototype.start = function () {
                                var _this = this;
                                if (!this.isPaused) {
                                    this.advance();
                                    window.setTimeout(function() {
                                            _this.start();
                                        },
                                        this.randomNumber(3500, 7500));
                                }
                            };
                            SlideShow.prototype.randomNumber = function (min, max) {
                                return Math.floor(Math.random() * (max - min + 1)) + min;
                            };
                            SlideShow.prototype.advance = function () {
                                var _this = this;
                                $(this.images[this.index]).fadeOut(this.fadeOutTime,
                                    function () {
                                        if (_this.index === _this.imageCount - 1) {
                                            _this.index = 0;
                                        } else {
                                            ++_this.index;
                                        }
                                        $(_this.images[_this.index]).fadeIn(_this.fadeInTime);
                                    });
                            };
                            return SlideShow;
                        }());

                        const slideShows = [
                            new SlideShow('#one'),
                            new SlideShow('#two'),
                            new SlideShow('#three'),
                            new SlideShow('#four')
                        ];
                        slideShows.forEach(ss => ss.start());
                    });
                </script>
            }

        </div>

    </div>
</div>

@if (Model.IsSingleImage)
{
    <script type="text/javascript">
        function onFacebookClick() {
            return this.parseMetaTagsAndShare('https://www.facebook.com/sharer/sharer.php',
                {
                    u: window.location.href
                });
        }

        function onTwitterClick() {
            return this.parseMetaTagsAndShare('https://twitter.com/intent/tweet',
                {
                    url: window.location.href,
                    text: getMetaContent('og:description', 'property'),
                    hashtags: getMetaContent('twitter:hashtags', 'name'),
                    via: getMetaContent('twitter:site', 'name')
                });
        }

        function onLinkedinClick() {
            return this.parseMetaTagsAndShare('http://www.linkedin.com/shareArticle',
                {
                    url: window.location.href,
                    title: getMetaContent('og:title', 'property'),
                    summary: getMetaContent('og:description', 'property')
                });
        }

        function onGooglePlusClick() {
            return this.parseMetaTagsAndShare('https://plus.google.com/share',
                {
                    url: window.location.href
                });
        }

        function parseMetaTagsAndShare(baseShareUrl, metaTags) {
            const queryParams = this.getQueryParams(metaTags);
            return this.share(`${baseShareUrl}?${queryParams}`);
        }

        function getQueryParams(metaTags) {
            let queryParams = '';
            if (metaTags) {
                queryParams =
                    Object.entries(metaTags)
                        .map(([key, metaTag]) =>
                            metaTag
                                ? `${key}=${encodeURIComponent(metaTag)}`
                                : ''
                        ).join('&');
            }
            return queryParams;
        }

        function getMetaContent(key, attr) {
            const metaTag = document.querySelector(`meta[${attr}="${key}"]`);
            return metaTag ? metaTag.getAttribute('content') : undefined;
        }

        function getWindowSize(width, height) {
            return `width=${width}, height=${height}`;
        }

        function share(url) {
            return window.open(url, 'newwindow', this.getWindowSize(800, 500));
        }
    </script>
}
